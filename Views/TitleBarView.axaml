<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MarkdownViewer.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sys="using:System"
             mc:Ignorable="d"
             x:Class="MarkdownViewer.Views.TitleBarView"
             x:CompileBindings="False">

    <Design.DataContext>
        <vm:MainViewModel/>
    </Design.DataContext>

    <Border Background="#FCFCFC" Padding="0" Height="32" Name="TitleBar">
        <Grid ColumnDefinitions="Auto,Auto,*,Auto">
            <!-- Hamburger Menu -->
            <Menu Grid.Column="0" Background="Transparent" VerticalAlignment="Center" Margin="4,0,0,0" Name="HamburgerMenu">
                <MenuItem Padding="8,4" Name="HamburgerMenuItem">
                    <MenuItem.Header>
                        <TextBlock Text="â˜°" FontSize="16" VerticalAlignment="Center" Foreground="#2C3E50"/>
                    </MenuItem.Header>
                    <!-- File Menu Items -->
                    <MenuItem Header="New" Command="{Binding NewFileCommand}" InputGesture="Ctrl+N" Name="NewMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ“„" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Open..." Command="{Binding OpenFileCommand}" InputGesture="Ctrl+O" Name="OpenMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ“‚" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator/>
                    <!-- Recent Files -->
                    <MenuItem Header="Recent Files" ItemsSource="{Binding RecentFiles}">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ“‚" FontSize="12"/>
                        </MenuItem.Icon>
                        <MenuItem.ItemTemplate>
                            <DataTemplate x:DataType="sys:String">
                                <MenuItem Header="{Binding}" Command="{Binding $parent[Menu].DataContext.OpenRecentFileCommand}" CommandParameter="{Binding}"/>
                            </DataTemplate>
                        </MenuItem.ItemTemplate>
                    </MenuItem>
                    <MenuItem Header="Clear Recent Files" Command="{Binding ClearRecentFilesCommand}" Name="ClearRecentMenuItem"/>
                    <Separator/>
                    <MenuItem Header="Save" Command="{Binding SaveFileCommand}" InputGesture="Ctrl+S" Name="SaveMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ’¾" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Save As..." Command="{Binding SaveFileAsCommand}" InputGesture="Ctrl+Shift+S" Name="SaveAsMenuItem"/>
                    <Separator/>
                    <!-- Edit Menu Items -->
                    <MenuItem Header="Bold" Command="{Binding ActiveDocument.EditorViewModel.InsertBoldCommand, TargetNullValue={x:Null}}" InputGesture="Ctrl+B" Name="BoldMenuItem">
                      <MenuItem.Icon>
                        <TextBlock Text="B" FontWeight="Bold" FontSize="12"/>
                      </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Italic" Command="{Binding ActiveDocument.EditorViewModel.InsertItalicCommand, TargetNullValue={x:Null}}" InputGesture="Ctrl+I" Name="ItalicMenuItem">
                      <MenuItem.Icon>
                        <TextBlock Text="I" FontStyle="Italic" FontSize="12"/>
                      </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Link" Command="{Binding ActiveDocument.EditorViewModel.InsertLinkCommand, TargetNullValue={x:Null}}" InputGesture="Ctrl+K" Name="LinkMenuItem">
                      <MenuItem.Icon>
                        <TextBlock Text="ðŸ”—" FontSize="12"/>
                      </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Image" Command="{Binding ActiveDocument.EditorViewModel.InsertImageCommand, TargetNullValue={x:Null}}" InputGesture="Ctrl+Shift+I" Name="ImageMenuItem">
                      <MenuItem.Icon>
                        <TextBlock Text="ðŸ–¼" FontSize="12"/>
                      </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Code Block" Command="{Binding ActiveDocument.EditorViewModel.InsertCodeBlockCommand, TargetNullValue={x:Null}}" InputGesture="Ctrl+Shift+C" Name="CodeBlockMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="&lt;/&gt;" FontSize="10" FontFamily="Consolas"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Table" Command="{Binding ActiveDocument.EditorViewModel.InsertTableCommand, TargetNullValue={x:Null}}" InputGesture="Ctrl+T" Name="TableMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="âŠž" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator/>
                    <!-- View Menu Items -->
                    <MenuItem Header="Toggle Read Mode" Command="{Binding ToggleReadModeCommand}" InputGesture="F6" Name="ToggleReadModeMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ‘" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator/>
                    <!-- Theme Selection -->
                    <MenuItem Header="Themes" Name="ThemesMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸŽ¨" FontSize="12"/>
                        </MenuItem.Icon>
                        <MenuItem Header="Glass Light (Default)" Command="{Binding SetGlassLightThemeCommand}" Name="GlassLightThemeItem">
                            <MenuItem.Icon>
                                <TextBlock Text="â˜€ï¸" FontSize="11"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Glass Dark" Command="{Binding SetGlassDarkThemeCommand}" Name="GlassDarkThemeItem">
                            <MenuItem.Icon>
                                <TextBlock Text="ðŸŒ™" FontSize="11"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Acrylic Light" Command="{Binding SetAcrylicLightThemeCommand}" Name="AcrylicLightThemeItem">
                            <MenuItem.Icon>
                                <TextBlock Text="ðŸ’Ž" FontSize="11"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Acrylic Dark" Command="{Binding SetAcrylicDarkThemeCommand}" Name="AcrylicDarkThemeItem">
                            <MenuItem.Icon>
                                <TextBlock Text="ðŸŒŒ" FontSize="11"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Pure Dark (Solid)" Command="{Binding SetPureDarkThemeCommand}" Name="PureDarkThemeItem">
                            <MenuItem.Icon>
                                <TextBlock Text="â¬›" FontSize="11"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <Separator/>
                    <!-- Tab Commands -->
                    <MenuItem Header="Close Tab" Command="{Binding CloseActiveTabCommand}" InputGesture="Ctrl+W" Name="CloseTabMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="x" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Close Other Tabs" Command="{Binding CloseOtherTabsCommand}" Name="CloseOtherTabsMenuItem"/>
                    <MenuItem Header="Close All Tabs" Command="{Binding CloseAllTabsCommand}" InputGesture="Ctrl+Shift+W" Name="CloseAllTabsMenuItem"/>
                    <Separator/>
                    <MenuItem Header="Copy HTML to Clipboard" Command="{Binding CopyHtmlToClipboardCommand}" InputGesture="Ctrl+Shift+H" Name="CopyHtmlMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ“‹" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Export HTML..." Command="{Binding ExportHtmlCommand}" Name="ExportHtmlMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ“¤" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator/>
                    <MenuItem Header="Check for Updates" Command="{Binding CheckForUpdatesCommand}" Name="CheckForUpdatesMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸ”„" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator/>
                    <MenuItem Header="Exit" Command="{Binding ExitCommand}" InputGesture="Alt+F4" Name="ExitMenuItem">
                        <MenuItem.Icon>
                            <TextBlock Text="ðŸšª" FontSize="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
            </Menu>

            <!-- App Icon & Title -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8" Margin="8,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="ðŸ“" FontSize="14" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding WindowTitle}" FontSize="12" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#2C3E50"/>
            </StackPanel>

            <!-- Window Control Buttons -->
            <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="0" HorizontalAlignment="Right">
                <Button Name="MinimizeButton" Width="46" Height="32" Padding="0" Background="Transparent" BorderThickness="0" ToolTip.Tip="Minimize">
                    <TextBlock Text="â”€" FontSize="12" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0,-8,0,0"/>
                </Button>
                <Button Name="MaximizeButton" Width="46" Height="32" Padding="0" Background="Transparent" BorderThickness="0" ToolTip.Tip="Maximize">
                    <TextBlock Text="â˜" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </Button>
                <Button Name="CloseButton" Width="46" Height="32" Padding="0" Background="Transparent" BorderThickness="0" ToolTip.Tip="Close">
                    <TextBlock Text="X" FontSize="12" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
